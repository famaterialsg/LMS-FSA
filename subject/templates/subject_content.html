{% extends 'base.html' %}

{% block title %}File Preview{% endblock %}

{% block extra_head %}
<style>
    .preview-container {
        width: 100%;
        height: 80vh; /* Set the height as needed */
        overflow-y: auto; /* Allow scrolling if content exceeds height */
    }
    .file-list {
        margin-bottom: 1rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-2xl font-bold mb-4">Select a File to Preview</h1>

    <!-- Button to edit subject content -->
    <a href="{% url 'subject:subject_content_edit' subject.pk %}" class="btn btn-warning mb-3">Edit Subject Content</a>

    <h2 class="text-xl font-semibold mb-2">Documents</h2>
    <div class="file-list">
        {% if documents %}
            <ul>
                {% for document in documents %}
                    <li>
                        <a href="#" onclick="showPreview('{{ document.doc_file.url }}', 'document')">{{ document.doc_title }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No documents available for this subject.</p>
        {% endif %}
    </div>

    <h2 class="text-xl font-semibold mb-2">Videos</h2>
    <div class="file-list">
        {% if videos %}
            <ul>
                {% for video in videos %}
                    <li>
                        <a href="#" onclick="showPreview('{{ video.vid_file.url }}', 'video')">{{ video.vid_title }}</a>
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No videos available for this subject.</p>
        {% endif %}
    </div>

    <div id="preview-content" class="preview-container">
        <p>Select a file from the lists above to preview it.</p>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    function showPreview(url, type) {
        const previewContent = document.getElementById('preview-content');
        previewContent.innerHTML = ''; // Clear previous content

        if (type === 'video') {
            previewContent.innerHTML = `
                <video controls class="w-100 h-100">
                    <source src="${url}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            `;
        } else {
            previewContent.innerHTML = `
                <iframe src="${url}" class="w-full h-full"></iframe>
            `;
        }
    }
</script>
{% endblock %}
