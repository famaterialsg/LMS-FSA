{% extends 'base.html' %}

{% block title %}Student Answers Report{% endblock %}

{% block content %}
<style>
    body {
        font-family: Arial, sans-serif;
        line-height: 1.6;
        background-color: #f8f9fa;
    }

    h1, h2 {
        color: #333;
        text-align: center;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 16px;
        text-align: left;
        background-color: #fff;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    table thead tr {
        background-color: #007bff;
        color: #fff;
        text-transform: uppercase;
    }

    table th, table td {
        padding: 12px 15px;
        border: 1px solid #ddd;
    }

    table tbody tr:nth-of-type(even) {
        background-color: #f3f3f3;
    }

    table tbody tr:hover {
        background-color: #f1f1f1;
    }

    p, td {
        color: #555;
    }

    .container {
        max-width: 1200px;
        margin: auto;
        padding: 20px;
    }

    .info {
        margin-bottom: 20px;
        padding: 10px;
        background-color: #e9ecef;
        border-radius: 5px;
        color: #555;
    }

    .info strong {
        color: #333;
    }
</style>

<div class="container">
    <h1>Student Answers Report for Assessment: {{ quiz.title }}</h1>
    
    <!-- User Info, Date, and Score -->
    <div class="info">
        <h2>Attempt by: 
            {% if attempt.user %}
                {{ attempt.user.username }}
            {% else %}
                {{ attempt.email }}
            {% endif %}
        </h2>
        <p><strong>Date:</strong> {{ attempt.attempt_date|date:"M d, Y, h:i a" }}</p>
        <p><strong>Score (Quiz):</strong> {{ attempt.score_quiz }}</p>
        <p><strong>Score (Assignment):</strong> {{ attempt.score_ass }}</p>
    </div>

    <table>
        <thead>
            <tr>
                <th>Question</th>
                <th>Your Answer(s)</th>
                <th>Correct Answer(s)</th>
                <th>Note</th>
            </tr>
        </thead>
        <tbody>
            {% for answer in student_answers %}
            <tr>
                <td>{{ answer.question.question_text }}</td>
    
                <!-- Hiển thị câu trả lời của học sinh -->
                <td>
                    {% if answer.selected_options.all %}
                        {% for option in answer.selected_options.all %}
                            <p>{{ option.option_text }}</p>
                        {% endfor %}
                    {% elif answer.text_response %}
                        <p>{{ answer.text_response }}</p>
                    {% else %}
                        <p>None</p>
                    {% endif %}
                </td>
    
                <!-- Hiển thị câu trả lời đúng -->
                <td>
                    {% for correct_answer in correct_answers %}
                        {% if correct_answer.0 == answer.question.id %}
                            {% for option in correct_answer.1 %}
                                <p>{{ option.option_text }}</p>
                            {% endfor %}
                        {% endif %}
                    {% endfor %}
                </td>
    
                <!-- Ghi chú thay bằng attempt_date -->
                <td>
                    <p>{{ attempt.attempt_date|date:"M d, Y, h:i a" }}</p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>        
</div>
{% endblock %}
