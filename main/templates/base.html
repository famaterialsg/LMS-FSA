<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Trang chủ{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container-fluid">
            {% if user.is_authenticated %}
                {% if request.user.is_superuser and request.session.temporary_role == 'Student' %}
                    <!-- Navbar cho superuser với role tạm thời là Student -->
                    {% include "student_navbar.html" %}
                {% elif request.user.profile.role.role_name == 'Student' %}
                    <!-- Navbar cho Student -->
                    {% include "student_navbar.html" %}
                {% else %}
                    <!-- Navbar cho Admin và các role khác không phải Student -->
                    {% include "admin_navbar.html" %}
                {% endif %}
            {% else %}
                <!-- Navbar cho người dùng chưa đăng nhập -->
                {% include "admin_navbar.html" %}
            {% endif %}
        </div>
    </div>

    <div class="container-fluid" style="display: flex; flex-direction: column;">
        <div class="row mt-5" style="flex-grow: 1;">
            <!-- Sidebar chỉ hiển thị cho Admin và các role khác không phải Student -->
            {% if user.is_authenticated %}
                {% if request.user.profile.role.role_name != 'Student' and request.session.temporary_role != 'Student' %}
                    <div class="col-md-2 col-sm-12 bg-dark mt-2" id="sidebar" style="overflow-y: auto; height: 95%; position: fixed; transition: transform 0.3s ease; z-index:10">
                        {% include "admin_sidebar.html" %}
                    </div>
                {% endif %}
            {% endif %}
    
            <!-- Nội dung chính -->
            <div class="mt-3
                {% if user.is_authenticated %}
                    {% if request.user.profile.role.role_name == 'Student' or request.session.temporary_role == 'Student' %}
                        col-sm-12
                    {% elif request.user.is_superuser or request.user.profile.role.role_name != 'Student' %}
                        col-md-10 col-sm-12 offset-md-2
                    {% endif %}
                {% else %}
                    col-sm-12
                {% endif %}
            " id="mainContentArea" style="transition: margin-left 0.3s ease;">
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>
    <button onclick="scrollToTop()" id="scrollToTopButton" title="Top page"
            class="btn position-fixed d-none rounded-circle p-2 shadow-lg"
            style="font-size: 20px; bottom: 3vh; right: 20px; transition: opacity 0.3s; background-color: black; color: white;">
        <i class="fas fa-arrow-up"></i>
    </button>


    <!-- JavaScript của Bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.3.0-alpha1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Lắng nghe sự kiện cuộn trang
        window.onscroll = function() {
            var scrollToTopButton = document.getElementById("scrollToTopButton");
    
            // Nếu cuộn trang xuống, nút sẽ hiển thị
            if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
                scrollToTopButton.classList.remove("d-none");
            } else {
                scrollToTopButton.classList.add("d-none");
            }
        };
    
        // Hàm cuộn lên đầu trang
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>
